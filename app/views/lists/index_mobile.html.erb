<div class="mobile-container">
  <!-- Mobile Search Bar -->
  <div class="mobile-search-container"
       data-controller="mobile-search"
       data-mobile-search-user-lists-value="<%= user_signed_in? && current_user.lists.any? ? current_user.lists.left_joins(:entries).group('lists.id').select('lists.id, lists.name, COUNT(entries.id) as entries_count').map { |list| { id: list.id, name: list.name, entries_count: list.entries_count } }.to_json : '[]' %>"
       data-mobile-search-api-key-value="7e1c210d0c877abff8a40398735ce605">

    <div class="search-container">
      <input type="text"
             class="form-control search-input"
             placeholder="Search movies & shows..."
             data-mobile-search-target="input"
             data-action="input->mobile-search#performSearch"
             style="width: 100%; max-width: 400px; margin: 0 auto;">
    </div>

    <!-- Search Results Overlay -->
    <div data-mobile-search-target="results"
         class="search-results-overlay position-fixed d-none"
         style="top: 20px; left: 50%; transform: translateX(-50%); width: 95vw; max-width: 600px; max-height: 80vh; overflow-y: auto; z-index: 1050; background: white; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.15);">

      <!-- Movie/Show Toggle Buttons at top of overlay -->
      <div class="p-3 border-bottom bg-light rounded-top"
           data-mobile-search-target="typeButtons">
        <div class="btn-group w-100" role="group">
          <input type="radio" class="btn-check" name="searchType" id="mobileMovieType" autocomplete="off" checked
                 data-action="change->mobile-search#switchToMovieSearch">
          <label class="btn btn-outline-primary btn-sm" for="mobileMovieType">Movies</label>

          <input type="radio" class="btn-check" name="searchType" id="mobileShowType" autocomplete="off"
                 data-action="change->mobile-search#switchToShowSearch">
          <label class="btn btn-outline-primary btn-sm" for="mobileShowType">Shows</label>
        </div>
      </div>

      <!-- Search Results Content -->
      <div data-mobile-search-target="resultsContent" class="p-3"></div>
    </div>
  </div>

  <!-- Mobile Favorites List Info -->
  <% if @favorites_list %>
    <div class="mobile-favorites-info mt-4 text-center">
      <h5>Your Favorites</h5>
      <p class="text-muted">
        <i class="fa-solid fa-heart me-1"></i>
        <%= @favorites_list.entries.count %> items in your favorites list
      </p>
      <%= link_to "View Favorites", list_path(@favorites_list), class: "btn btn-primary" %>
    </div>
  <% end %>
</div>

<style>
.mobile-container {
  padding: 20px;
  max-width: 600px;
  margin: 0 auto;
}

.mobile-search-container {
  text-align: center;
}

.search-input {
  font-size: 16px; /* Prevents zoom on iOS */
  padding: 12px;
  border-radius: 25px;
  border: 2px solid #e9ecef;
}

.search-input:focus {
  border-color: #dc3545;
  box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25);
}

.card {
  border: none;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.card-body {
  padding: 0.75rem;
}

.btn-primary {
  background-color: #dc3545;
  border-color: #dc3545;
}

.btn-primary:hover {
  background-color: #c82333;
  border-color: #bd2130;
}
</style>
